# Krypto Trader Bot — Торговля вымышленной криптовалютой

## О проекте

**Krypto Trader Bot** — это Telegram-бот для игры на виртуальной бирже. Пользователи могут покупать и продавать вымышленную криптовалюту, цена которой генерируется случайным образом. Бот позволяет отслеживать динамику цен через графики, соревноваться с другими игроками и развивать свои трейдерские навыки в безопасной игровой среде.

---

## Основные возможности

-  Торговля криптовалютой: Покупка и продажа виртуальной криптовалюты
- Анализ графиков: Визуализация ценовой динамики за выбранный период
- Рейтинг игроков: Топ-5 лучших трейдеров по совокупному балансу
- Сохранение прогресса: Автоматическое сохранение данных каждого пользователя
- Автоматическая генерация цен: Случайная генерация котировок для реалистичности

---

## Технологии

- Python 3.7+
- python-telegram-bot — для взаимодействия с Telegram API
- matplotlib — для построения графиков
- numpy — для работы с числовыми данными
- JSON — для хранения пользовательских данных и истории цен

---

## Структура проекта

```
krypto_trader_bot/
├── krypto_bot.py          # Основной файл бота
├── graph_file.json        # История цен криптовалюты
├── top_players.json       # Рейтинг лучших игроков
├── user_data/             # Директория с данными пользователей
│   └── user_<ID>.json    # Персональные данные каждого пользователя
└── README.md              # Этот файл
```

---

## Установка и запуск

### 1. Клонирование и настройка

```bash
# Клонируйте репозиторий
git clone <ваш-репозиторий>
cd krypto_trader_bot

# Установите зависимости
pip install python-telegram-bot matplotlib numpy
```

### 2. Настройка бота

1. Создайте бота через [@BotFather](https://t.me/botfather) в Telegram
2. Получите токен вашего бота
3. В файле `krypto_bot.py` замените значение `TOKEN` на ваш токен:
   ```python
   TOKEN = "ВАШ_ТОКЕН_ЗДЕСЬ"
   ```

### 3. Запуск бота

```bash
python krypto_bot.py
```

После запуска вы увидите сообщение: `"Бот запущен..."`

---

## Команды бота

### `/start` — Начало работы
Регистрирует пользователя и показывает доступные команды.

### `/buy [количество]` — Купить криптовалюту
Покупка указанного количества криптовалюты по текущей цене.

**Пример:** `/buy 10`

### `/sell [количество]` — Продать криптовалюту
Продажа указанного количества криптовалюты по текущей цене.

**Пример:** `/sell 5`

### `/graph [период]` — Показать график цен
Отображает график цен криптовалюты за указанный период (количество последних точек).

**Пример:** `/graph 30` — покажет график за последние 30 временных точек

### `/top` — Топ игроков
Показывает 5 лучших игроков по совокупному балансу.

---

## Игровая механика

### Баланс
У каждого игрока есть два типа баланса:
- Криптовалюта (KR) — виртуальная криптовалюта
- Деньги (RUB) — виртуальные рубли для покупки криптовалюты

Начальный баланс: 512 RUB

### Система цен
- Цена криптовалюты генерируется случайным образом
- Диапазон цен: 1-100 RUB за 1 единицу криптовалюты
- История из 50 последних цен сохраняется в `graph_file.json`
- При запуске создается новая случайная последовательность цен

### Рейтинговая система
Игроки ранжируются по совокупному балансу:
```
Совокупный баланс = (Количество крипты × Текущая цена) + Денежный баланс
```

---

## Как это работает

### Генерация цен
```python
# При первом запуске создается 50 случайных цен
[random.randint(1, 100) for _ in range(50)]
# Пример: [45, 78, 23, 91, 12, ...]
```

### Хранение данных
- **Пользовательские данные**: Каждый пользователь сохраняется в отдельном JSON-файле
- **История цен**: Общая для всех пользователей, хранится в `graph_file.json`
- **Рейтинг**: Топ игроков сохраняется в `top_players.json`

### Графики
Бот создает графики с помощью matplotlib и сохраняет их как PNG-файлы перед отправкой в Telegram.

---

## Известные ограничения

1. **Случайность цен**: Цены полностью случайны, без реальной рыночной логики
2. **Ограниченная история**: Только 50 последних цен в истории
3. **Нет реального времени**: Цены не обновляются в реальном времени, только при совершении операций
4. **Проблемы с сетью**: При отправке графиков могут возникать таймауты (есть механизм повторных попыток)

---

## Возможности для улучшения

- [ ] Реальные API: Интеграция с CoinGecko или Binance API для реальных цен
- [ ] Игровые события: Случайные рыночные события (падения, взлеты цен)
- [ ] Ежедневные бонусы: Награды за ежедневный вход
- [ ] Социальные функции: Возможность отправлять крипту другим игрокам
- [ ] Уведомления: Оповещения о значительных изменениях цен

---

## Важная информация

- Бот использует локальное хранилище (JSON-файлы)
- Все данные хранятся в папке `user_data/`
- При удалении файлов прогресс пользователей сбрасывается
- Для работы бота нужен стабильный интернет и доступ к Telegram

---

## Для разработчиков

### Основные функции
```python
load_user_data(user_id)     # Загрузка данных пользователя
save_user_data(user_id, data) # Сохранение данных пользователя
load_graph_data()           # Загрузка истории цен
create_sample_graph(m, g)   # Создание графика
balance(data)               # Расчет и обновление баланса
```

### Добавление новых команд
Для добавления новой команды:
1. Создайте async-функцию-обработчик
2. Добавьте обработчик в `main()`:
   ```python
   application.add_handler(CommandHandler("команда", функция))
   ```



**Удачной торговли! **
